server {
	listen		80;
	server_name	coupon.ill.gold ill.gold;
	return 		301	https://coupon.ill.gold$request_uri;
}

server {
        listen      443 ssl http2;
	server_name coupon.ill.gold;
	ssl_certificate		ssl/coupon.ill.gold.crt;
	ssl_certificate_key	ssl/coupon.ill.gold.key;
	ssl_protocols		TLSv1.1 TLSv1.2 TLSv1.3;
	index index.php index.htm index.html;
	root  /opt/case/coupon;

        autoindex off;

        add_header Strict-Transport-Security "max-age=31536000";

        error_page 404  /404.html;
        location = favicon.ico {
                log_not_found off;
                access_log off;
        }

        location / {
                try_files $uri $uri/ /index.php?$query_string;
        }

        location ~ .*\.php?$ {
                fastcgi_pass   php:9000;
                #fastcgi_pass   unix:/opt/app/php/var/run/php_web.socket;
                fastcgi_index  index.php;
                fastcgi_param  SCRIPT_FILENAME    $realpath_root$fastcgi_script_name;
                include        fastcgi_params;
        }

        rewrite_log on;

        access_log   /opt/logs/nginx/coupon.ill.gold.access.log main;
        error_log    /opt/logs/nginx/coupon.ill.gold.error.log warn;
}
